{"variants":[{"paths":["\/documentation\/errorcode\/errorcode(codelength:delimiter:codecharacters:)"],"traits":[{"interfaceLanguage":"swift"}]}],"hierarchy":{"paths":[["doc:\/\/ErrorCode\/documentation\/ErrorCode"]]},"schemaVersion":{"major":0,"minor":3,"patch":0},"identifier":{"url":"doc:\/\/ErrorCode\/documentation\/ErrorCode\/ErrorCode(codeLength:delimiter:codeCharacters:)","interfaceLanguage":"swift"},"kind":"symbol","abstract":[{"text":"Adds a pseudo-random, alphanumeric ","type":"text"},{"isActive":true,"type":"reference","identifier":"doc:\/\/ErrorCode\/documentation\/ErrorCode\/ErrorCode\/opaqueCode"},{"text":" ","type":"text"},{"type":"codeVoice","code":"String"},{"text":" property to each member of an ","type":"text"},{"code":"enum","type":"codeVoice"},{"type":"text","text":" declaration that is safe to present to a user without unintentionally exposing implementation details. This "},{"code":"opaqueCode","type":"codeVoice"},{"text":" can be used to re-construct the ","type":"text"},{"identifier":"doc:\/\/ErrorCode\/documentation\/ErrorCode\/ErrorCode","type":"reference","isActive":true},{"type":"text","text":" that produced it by calling the synthesized "},{"identifier":"doc:\/\/ErrorCode\/documentation\/ErrorCode\/ErrorCode\/init(opaqueCode:)","isActive":true,"type":"reference"},{"text":" initializer.","type":"text"}],"sections":[],"primaryContentSections":[{"kind":"declarations","declarations":[{"languages":["swift"],"platforms":["macOS"],"tokens":[{"text":"@attached","kind":"attribute"},{"text":"(extension, conformances: ","kind":"text"},{"text":"ErrorCode","identifier":"doc:\/\/ErrorCode\/documentation\/ErrorCode\/ErrorCode","preciseIdentifier":"s:9ErrorCodeAAP","kind":"typeIdentifier"},{"text":", names: named(OpaqueCode), named(opaqueCode), named(childOpaqueCode), named(init(opaqueCode:)), named(childErrorCode(for:)), named(OpaqueCodeError)) ","kind":"text"},{"kind":"keyword","text":"macro"},{"kind":"text","text":" "},{"text":"ErrorCode","kind":"identifier"},{"text":"(","kind":"text"},{"text":"codeLength","kind":"externalParam"},{"text":": ","kind":"text"},{"text":"Int","kind":"typeIdentifier","preciseIdentifier":"s:Si"},{"text":"? = nil, ","kind":"text"},{"text":"delimiter","kind":"externalParam"},{"kind":"text","text":": "},{"preciseIdentifier":"s:s12StaticStringV","text":"StaticString","kind":"typeIdentifier"},{"text":"? = nil, ","kind":"text"},{"kind":"externalParam","text":"codeCharacters"},{"text":": ","kind":"text"},{"kind":"typeIdentifier","preciseIdentifier":"s:s12StaticStringV","text":"StaticString"},{"kind":"text","text":"? = nil)"}]}]},{"content":[{"anchor":"overview","type":"heading","level":2,"text":"Overview"},{"type":"paragraph","inlineContent":[{"text":"Exposing error names or detailed descriptions to the user can be confusing to a non-technical person, and a potential security risk if it describes implementation details. This macro, which provides a default implementation of ","type":"text"},{"identifier":"doc:\/\/ErrorCode\/documentation\/ErrorCode\/ErrorCode","type":"reference","isActive":true},{"type":"text","text":", allows the developer to create a large list of error codes as Swift "},{"type":"codeVoice","code":"enum"},{"type":"text","text":" types that contain detailed descriptions of what went wrong, as well as where. These types can then be exposed to the user safely using their "},{"isActive":true,"type":"reference","identifier":"doc:\/\/ErrorCode\/documentation\/ErrorCode\/ErrorCode\/opaqueCode"},{"text":" property. This code can then be reported via analytics, or manually by the user, then used with the ","type":"text"},{"identifier":"doc:\/\/ErrorCode\/documentation\/ErrorCode\/ErrorCode\/init(opaqueCode:)","type":"reference","isActive":true},{"text":" initializer to see exactly which error code was triggered, and potentially even where it was triggered in code.","type":"text"}]},{"type":"heading","anchor":"Basic-usage","text":"Basic usage","level":3},{"type":"paragraph","inlineContent":[{"text":"To use this macro, simply apply it to an ","type":"text"},{"type":"codeVoice","code":"enum"},{"text":" declaration:","type":"text"}]},{"code":["@ErrorCode","enum AppErrorCode {","   case error1","   ...","}"],"type":"codeListing","syntax":"swift"},{"type":"paragraph","inlineContent":[{"type":"text","text":"This will synthesize the "},{"identifier":"doc:\/\/ErrorCode\/documentation\/ErrorCode\/ErrorCode\/opaqueCode","isActive":true,"type":"reference"},{"type":"text","text":" and "},{"identifier":"doc:\/\/ErrorCode\/documentation\/ErrorCode\/ErrorCode\/init(opaqueCode:)","isActive":true,"type":"reference"},{"type":"text","text":" declarations for you, as well as a couple of private types:"}]},{"inlineContent":[{"type":"text","text":"The "},{"code":"OpaqueCode","type":"codeVoice"},{"text":" type contains a list of static properties containing the ","type":"text"},{"type":"codeVoice","code":"String"},{"type":"text","text":" literal opaque code values for each case."}],"type":"paragraph"},{"type":"paragraph","inlineContent":[{"type":"text","text":"The "},{"type":"codeVoice","code":"OpaqueCodeError"},{"text":" type contains a few errors that may be thrown when initializing an ","type":"text"},{"type":"reference","identifier":"doc:\/\/ErrorCode\/documentation\/ErrorCode\/ErrorCode","isActive":true},{"type":"text","text":" from the throwing "},{"type":"reference","identifier":"doc:\/\/ErrorCode\/documentation\/ErrorCode\/ErrorCode\/init(opaqueCode:)","isActive":true},{"text":" initializer.","type":"text"}]},{"type":"heading","level":3,"text":"Nested error codes","anchor":"Nested-error-codes"},{"inlineContent":[{"type":"text","text":"Error codes can be nested into each other using associated values on "},{"code":"enum","type":"codeVoice"},{"type":"text","text":" cases:"}],"type":"paragraph"},{"code":["@ErrorCode","enum AppErrorCode {","   case error1(NestedErrorCode)","   case error2(child: NestedErrorCode)","   case error3","   ...","}","","@ErrorCode","enum NestedErrorCode {","   case nested1","   ...","}"],"type":"codeListing","syntax":"swift"},{"inlineContent":[{"text":"Associated values can have names, but they aren’t required, and not all cases on a type need to have associated values.. The only requirement is that all of the error codes conform to the ","type":"text"},{"isActive":true,"type":"reference","identifier":"doc:\/\/ErrorCode\/documentation\/ErrorCode\/ErrorCode"},{"text":" protocol. ","type":"text"},{"type":"reference","identifier":"doc:\/\/ErrorCode\/documentation\/ErrorCode\/ErrorCode\/opaqueCode","isActive":true},{"type":"text","text":" values from nested error codes combine each level in to one "},{"code":"String","type":"codeVoice"},{"text":" delimeted by a hyphen (","type":"text"},{"code":"-","type":"codeVoice"},{"type":"text","text":") between each level, starting from the top most error code at the start of the string and going down through the nesting. For example, the above "},{"type":"codeVoice","code":"AppErrorCode"},{"type":"text","text":" of "},{"code":"AppErrorCode.error1(.nested1)","type":"codeVoice"},{"text":", if ","type":"text"},{"type":"codeVoice","code":"error1"},{"text":" had an  opaque code of ","type":"text"},{"code":"\"AAAA\"","type":"codeVoice"},{"type":"text","text":" and "},{"code":"nested1","type":"codeVoice"},{"text":" had an opaque code of ","type":"text"},{"type":"codeVoice","code":"\"BBBB\""},{"type":"text","text":", the combined, nested code would be "},{"type":"codeVoice","code":"\"AAAA-BBBB\""},{"text":".","type":"text"}],"type":"paragraph"},{"text":"Custom opaque code lengths","level":3,"type":"heading","anchor":"Custom-opaque-code-lengths"},{"type":"paragraph","inlineContent":[{"text":"The ","type":"text"},{"type":"codeVoice","code":"codeLength"},{"text":" optional parameter can be used to override the generated code length. By default, this value is ","type":"text"},{"type":"codeVoice","code":"4"},{"type":"text","text":", but it can be any length. You may wish to have shorter codes for ease of reporting and debugging, but the shorter the code, the more likely that the generated codes will collide. If this happens, an error is reported with possible fixits, one of which is to increase the "},{"code":"codeLength","type":"codeVoice"},{"type":"text","text":" parameter by "},{"code":"1","type":"codeVoice"},{"text":".","type":"text"}]},{"type":"paragraph","inlineContent":[{"text":"### Custom child code delimiter","type":"text"},{"type":"text","text":" "},{"type":"text","text":"The "},{"code":"delimiter","type":"codeVoice"},{"type":"text","text":" optional parameter can be used to override the default "},{"code":"\"-\"","type":"codeVoice"},{"type":"text","text":" delimiter placed between parent and child codes. This must not be an empty string."}]},{"text":"Custom opaque code characters","type":"heading","anchor":"Custom-opaque-code-characters","level":3},{"inlineContent":[{"type":"text","text":"The "},{"type":"codeVoice","code":"codeCharacters"},{"type":"text","text":" optional parameter can be used to override which characters are used when generating opaque codes. By default the "},{"type":"codeVoice","code":"[a-zA-Z0-9]"},{"type":"text","text":" characters are used. The provided "},{"type":"codeVoice","code":"String"},{"text":" must contain at least five unique characters, and duplicate characters are ignored.","type":"text"}],"type":"paragraph"},{"anchor":"Additional-generated-code","level":3,"type":"heading","text":"Additional generated code"},{"inlineContent":[{"type":"text","text":"If you apply this macro to a nested "},{"code":"enum","type":"codeVoice"},{"type":"text","text":" and expand the generated source code, you will see two further private functions are generated. "},{"type":"codeVoice","code":"childOpaqueCode(for:)"},{"type":"text","text":" is used as a type safe way of getting the "},{"type":"reference","isActive":true,"identifier":"doc:\/\/ErrorCode\/documentation\/ErrorCode\/ErrorCode\/opaqueCode"},{"type":"text","text":" from a nested error code, and the static "},{"code":"childErrorCode(for:)","type":"codeVoice"},{"text":" function does the reverse to create a nested error code from an opaque code ","type":"text"},{"type":"codeVoice","code":"String"},{"type":"text","text":". The default implementations are very simple, but they provide a way of customising how child opaque codes are handled by a parent, without having to manually declare the "},{"type":"reference","isActive":true,"identifier":"doc:\/\/ErrorCode\/documentation\/ErrorCode\/ErrorCode\/init(opaqueCode:)"},{"text":" initializer, which is largely boilerplate code. More on overriding generated code is exxplained below.","type":"text"}],"type":"paragraph"},{"anchor":"Overriding-generated-code","text":"Overriding generated code","level":3,"type":"heading"},{"type":"paragraph","inlineContent":[{"type":"text","text":"As stated above, the "},{"type":"codeVoice","code":"ErrorCode(codeLength:)"},{"text":" macro simply generates a conformance to the ","type":"text"},{"identifier":"doc:\/\/ErrorCode\/documentation\/ErrorCode\/ErrorCode","isActive":true,"type":"reference"},{"type":"text","text":" protocol. Most of this generated code is basic boilerplate, and the generated code will work as is. However, should you want to customise the generated implementation, each generated function and type can be manually declared, and the macro will intelligently verify that that declaration is valid, and then use it instead of generating it. There are a few requirements for this:"}]},{"type":"orderedList","items":[{"content":[{"inlineContent":[{"text":"The ","type":"text"},{"type":"codeVoice","code":"opaqueCode"},{"type":"text","text":" property must have the correct access modifier for it’s containing type to satisfy the "},{"isActive":true,"identifier":"doc:\/\/ErrorCode\/documentation\/ErrorCode\/ErrorCode","type":"reference"},{"type":"text","text":" protocol, and must not have a getter that is "},{"code":"async","type":"codeVoice"},{"text":" or ","type":"text"},{"type":"codeVoice","code":"throws"},{"type":"text","text":". Declaring this property manually prevents the "},{"code":"childOpaqueCode(for:)","type":"codeVoice"},{"type":"text","text":" function from being generated by the macro as it will no longer be used."}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"The "},{"code":"init(opaqueCode:)","type":"codeVoice"},{"type":"text","text":" initializer must also have the correct access modifier for it’s containing type to satisfy the "},{"isActive":true,"type":"reference","identifier":"doc:\/\/ErrorCode\/documentation\/ErrorCode\/ErrorCode"},{"type":"text","text":" protocol, and must not be failable or "},{"code":"async","type":"codeVoice"},{"type":"text","text":", though it does not have to be a throwing initializer. Declaring this initializer manually prevents the "},{"type":"codeVoice","code":"childErrorCode(for:)"},{"type":"text","text":" function and "},{"code":"OpaqueCodeError","type":"codeVoice"},{"text":" ","type":"text"},{"code":"enum","type":"codeVoice"},{"text":" from being generated by the macro as they will no longer be used.","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"The ","type":"text"},{"type":"codeVoice","code":"OpaqueCode"},{"type":"text","text":" can be declared as an "},{"type":"codeVoice","code":"enum"},{"type":"text","text":", "},{"type":"codeVoice","code":"struct"},{"text":", ","type":"text"},{"type":"codeVoice","code":"class"},{"type":"text","text":" or "},{"type":"codeVoice","code":"actor"},{"type":"text","text":", and MUST contain one "},{"type":"codeVoice","code":"static"},{"text":" property declared as ","type":"text"},{"code":"let","type":"codeVoice"},{"text":" with a ","type":"text"},{"code":"String","type":"codeVoice"},{"type":"text","text":" literal initializer for each case in it’s containing type. An error will be generated if any cases are omitted. Other functionality can be declared in this type without effecting the macro."}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"The "},{"type":"codeVoice","code":"childOpaqueCode(for:)"},{"text":" and ","type":"text"},{"type":"codeVoice","code":"childErrorCode(for:)"},{"type":"text","text":" functions can by individually overriden, or both overridden at the same time. The only requirement is that they are not "},{"code":"async","type":"codeVoice"},{"type":"text","text":", and that "},{"code":"childErrorCode(for:)","type":"codeVoice"},{"text":" does not ","type":"text"},{"type":"codeVoice","code":"throw"},{"text":". It should be noted however, that any modifications to child opaque codes made in ","type":"text"},{"code":"childOpaqueCode(for:)","type":"codeVoice"},{"type":"text","text":" "},{"inlineContent":[{"type":"text","text":"MUST"}],"type":"strong"},{"type":"text","text":" be reversed in "},{"type":"codeVoice","code":"childErrorCode(for:)"},{"type":"text","text":" for the generated "},{"type":"reference","isActive":true,"identifier":"doc:\/\/ErrorCode\/documentation\/ErrorCode\/ErrorCode\/init(opaqueCode:)"},{"type":"text","text":" initializer to pattern match and work correctly."}]}]},{"content":[{"inlineContent":[{"text":"The ","type":"text"},{"code":"OpaqueCodeError","type":"codeVoice"},{"type":"text","text":" "},{"type":"codeVoice","code":"enum"},{"text":" can be manually declared to add other cases, and can be declared as an ","type":"text"},{"code":"enum","type":"codeVoice"},{"type":"text","text":", "},{"code":"struct","type":"codeVoice"},{"text":", ","type":"text"},{"code":"class","type":"codeVoice"},{"type":"text","text":" or "},{"code":"actor","type":"codeVoice"},{"type":"text","text":". If the "},{"type":"reference","identifier":"doc:\/\/ErrorCode\/documentation\/ErrorCode\/ErrorCode\/init(opaqueCode:)","isActive":true},{"type":"text","text":" initializer is being generated then this manual declaration must conform to the "},{"identifier":"doc:\/\/ErrorCode\/documentation\/ErrorCode\/OpaqueCodeInitializerError","type":"reference","isActive":true},{"type":"text","text":" protocol, as there are members on this type that are used by the generated code. "},{"inlineContent":[{"text":"Note","type":"text"}],"type":"emphasis"},{"text":" that the protocol requirements can be satisfied by ","type":"text"},{"type":"codeVoice","code":"enum"},{"text":" cases in place of ","type":"text"},{"code":"static","type":"codeVoice"},{"type":"text","text":" properties or functions. If both the "},{"identifier":"doc:\/\/ErrorCode\/documentation\/ErrorCode\/ErrorCode\/init(opaqueCode:)","isActive":true,"type":"reference"},{"text":" and ","type":"text"},{"code":"OpaqueCodeError","type":"codeVoice"},{"text":" types are declared manually, then no conformance to ","type":"text"},{"identifier":"doc:\/\/ErrorCode\/documentation\/ErrorCode\/OpaqueCodeInitializerError","type":"reference","isActive":true},{"type":"text","text":" is required."}],"type":"paragraph"}]}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"All of these requirements should be enforced by compiler warnings and errors. If anything doesn’t work as expected, please submit an issue."}]}],"kind":"content"}],"metadata":{"role":"symbol","roleHeading":"Macro","externalID":"s:9ErrorCodeAA10codeLength9delimiter0C10CharactersySiSg_s12StaticStringVSgAHtcfm","modules":[{"name":"ErrorCode"}],"symbolKind":"macro","title":"ErrorCode(codeLength:delimiter:codeCharacters:)","fragments":[{"text":"macro","kind":"keyword"},{"kind":"text","text":" "},{"kind":"identifier","text":"ErrorCode"},{"text":"(","kind":"text"},{"text":"codeLength","kind":"externalParam"},{"text":": ","kind":"text"},{"preciseIdentifier":"s:Si","kind":"typeIdentifier","text":"Int"},{"kind":"text","text":"?, "},{"kind":"externalParam","text":"delimiter"},{"text":": ","kind":"text"},{"kind":"typeIdentifier","text":"StaticString","preciseIdentifier":"s:s12StaticStringV"},{"text":"?, ","kind":"text"},{"kind":"externalParam","text":"codeCharacters"},{"kind":"text","text":": "},{"text":"StaticString","kind":"typeIdentifier","preciseIdentifier":"s:s12StaticStringV"},{"text":"?)","kind":"text"}]},"references":{"doc://ErrorCode/documentation/ErrorCode":{"type":"topic","kind":"symbol","identifier":"doc:\/\/ErrorCode\/documentation\/ErrorCode","abstract":[],"role":"collection","title":"ErrorCode","url":"\/documentation\/errorcode"},"doc://ErrorCode/documentation/ErrorCode/OpaqueCodeInitializerError":{"abstract":[{"text":"The error type used by the ","type":"text"},{"code":"init(opaqueCode:)","type":"codeVoice"},{"text":" initializer generated by the ","type":"text"},{"type":"codeVoice","code":"@ErrorCode"},{"type":"text","text":" macro."}],"title":"OpaqueCodeInitializerError","role":"symbol","navigatorTitle":[{"text":"OpaqueCodeInitializerError","kind":"identifier"}],"identifier":"doc:\/\/ErrorCode\/documentation\/ErrorCode\/OpaqueCodeInitializerError","url":"\/documentation\/errorcode\/opaquecodeinitializererror","type":"topic","kind":"symbol","fragments":[{"kind":"keyword","text":"protocol"},{"text":" ","kind":"text"},{"kind":"identifier","text":"OpaqueCodeInitializerError"}]},"doc://ErrorCode/documentation/ErrorCode/ErrorCode(codeLength:delimiter:codeCharacters:)":{"url":"\/documentation\/errorcode\/errorcode(codelength:delimiter:codecharacters:)","type":"topic","title":"ErrorCode(codeLength:delimiter:codeCharacters:)","kind":"symbol","role":"symbol","identifier":"doc:\/\/ErrorCode\/documentation\/ErrorCode\/ErrorCode(codeLength:delimiter:codeCharacters:)","abstract":[{"text":"Adds a pseudo-random, alphanumeric ","type":"text"},{"type":"reference","identifier":"doc:\/\/ErrorCode\/documentation\/ErrorCode\/ErrorCode\/opaqueCode","isActive":true},{"text":" ","type":"text"},{"type":"codeVoice","code":"String"},{"text":" property to each member of an ","type":"text"},{"code":"enum","type":"codeVoice"},{"type":"text","text":" declaration that is safe to present to a user without unintentionally exposing implementation details. This "},{"code":"opaqueCode","type":"codeVoice"},{"type":"text","text":" can be used to re-construct the "},{"identifier":"doc:\/\/ErrorCode\/documentation\/ErrorCode\/ErrorCode","isActive":true,"type":"reference"},{"type":"text","text":" that produced it by calling the synthesized "},{"isActive":true,"identifier":"doc:\/\/ErrorCode\/documentation\/ErrorCode\/ErrorCode\/init(opaqueCode:)","type":"reference"},{"type":"text","text":" initializer."}],"fragments":[{"kind":"keyword","text":"macro"},{"text":" ","kind":"text"},{"text":"ErrorCode","kind":"identifier"},{"kind":"text","text":"("},{"text":"codeLength","kind":"externalParam"},{"text":": ","kind":"text"},{"kind":"typeIdentifier","preciseIdentifier":"s:Si","text":"Int"},{"text":"?, ","kind":"text"},{"text":"delimiter","kind":"externalParam"},{"kind":"text","text":": "},{"preciseIdentifier":"s:s12StaticStringV","text":"StaticString","kind":"typeIdentifier"},{"text":"?, ","kind":"text"},{"text":"codeCharacters","kind":"externalParam"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"StaticString","preciseIdentifier":"s:s12StaticStringV"},{"text":"?)","kind":"text"}]},"doc://ErrorCode/documentation/ErrorCode/ErrorCode":{"identifier":"doc:\/\/ErrorCode\/documentation\/ErrorCode\/ErrorCode","navigatorTitle":[{"kind":"identifier","text":"ErrorCode"}],"url":"\/documentation\/errorcode\/errorcode","title":"ErrorCode","role":"symbol","kind":"symbol","fragments":[{"kind":"keyword","text":"protocol"},{"text":" ","kind":"text"},{"text":"ErrorCode","kind":"identifier"}],"type":"topic","abstract":[{"type":"text","text":"Defines an interface for converting a type to and from some opaque "},{"type":"codeVoice","code":"String"},{"type":"text","text":" representation."}]},"doc://ErrorCode/documentation/ErrorCode/ErrorCode/init(opaqueCode:)":{"kind":"symbol","abstract":[{"type":"text","text":"Creates an instance of the conforming type from it’s corresponding "},{"code":"opaqueCode","type":"codeVoice"},{"type":"text","text":"."}],"url":"\/documentation\/errorcode\/errorcode\/init(opaquecode:)","required":true,"fragments":[{"kind":"identifier","text":"init"},{"text":"(","kind":"text"},{"text":"opaqueCode","kind":"externalParam"},{"text":": ","kind":"text"},{"kind":"typeIdentifier","text":"String","preciseIdentifier":"s:SS"},{"text":") ","kind":"text"},{"text":"throws","kind":"keyword"}],"identifier":"doc:\/\/ErrorCode\/documentation\/ErrorCode\/ErrorCode\/init(opaqueCode:)","role":"symbol","type":"topic","title":"init(opaqueCode:)"},"doc://ErrorCode/documentation/ErrorCode/ErrorCode/opaqueCode":{"url":"\/documentation\/errorcode\/errorcode\/opaquecode","type":"topic","title":"opaqueCode","kind":"symbol","required":true,"identifier":"doc:\/\/ErrorCode\/documentation\/ErrorCode\/ErrorCode\/opaqueCode","abstract":[{"type":"text","text":"A "},{"code":"String","type":"codeVoice"},{"text":" representation of this instance, that is opaque to the user and does not expose any implementation details.","type":"text"}],"role":"symbol","fragments":[{"kind":"keyword","text":"var"},{"kind":"text","text":" "},{"kind":"identifier","text":"opaqueCode"},{"text":": ","kind":"text"},{"preciseIdentifier":"s:SS","text":"String","kind":"typeIdentifier"}]}}}